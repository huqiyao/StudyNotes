# èŠ‚æµé˜²æŠ–



* [ä¸ºä»€ä¹ˆéœ€è¦èŠ‚æµé˜²æŠ–æŠ€æœ¯](#ä¸ºä»€ä¹ˆéœ€è¦èŠ‚æµé˜²æŠ–æŠ€æœ¯)
* [å‡½æ•°é˜²æŠ–Debounce](#å‡½æ•°é˜²æŠ–Debounce)
  * [debounceä½œç”¨](#debounceä½œç”¨)
  * [æ‰‹å†™é˜²æŠ–](#æ‰‹å†™é˜²æŠ–)
* [å‡½æ•°èŠ‚æµThrottle](#å‡½æ•°èŠ‚æµThrottle)
  * [throttleä½œç”¨](#throttleä½œç”¨)
  * [æ‰‹å†™èŠ‚æµ](#æ‰‹å†™èŠ‚æµ)

- [å·¥å…·åº“](#å·¥å…·åº“)
  - [lodash](#lodash)



## ä¸ºä»€ä¹ˆéœ€è¦èŠ‚æµé˜²æŠ–æŠ€æœ¯

:thought_balloon: å¯¹äºé¢‘ç¹è§¦å‘çš„äº‹ä»¶ï¼Œé€šè¿‡èŠ‚æµå’Œé˜²æŠ–æŠ€æœ¯ï¼Œå¯ä»¥å‡å°‘äº‹ä»¶å¤„ç†å‡½æ•°è¢«è°ƒç”¨çš„æ¬¡æ•°ã€‚



## å‡½æ•°é˜²æŠ– Debounce



### debounceä½œç”¨

:wrench: ä½¿åœ¨äº‹ä»¶è¢«è§¦å‘nç§’åå†æ‰§è¡Œå›è°ƒï¼Œå¦‚æœåœ¨è¿™nç§’å†…åˆè¢«è§¦å‘ï¼Œåˆ™é‡æ–°è®¡æ—¶

**å³å¯¹äºé¢‘ç¹è§¦å‘çš„äº‹ä»¶ï¼Œåªåœ¨æœ€åä¸€æ¬¡è§¦å‘ï¼ˆè§¦å‘åœé¡¿æ—¶é—´>nç§’ï¼‰æ—¶æ‰æ‰§è¡Œäº‹ä»¶å¤„ç†å‡½æ•°**

```tsx
const handleClick=()=>{
  console.log(this) // window
}
<div onclick='handleClick()'>ç‚¹å‡»</div>
```



### æ‰‹å†™é˜²æŠ–

- åªè€ƒè™‘è®¡æ—¶å™¨æ¸…é™¤

  ```tsx
  // å†™æ³•1
  const debounce = (fn, delay)=>{
    // â“ä¸ºä»€ä¹ˆå†™åœ¨è¿™ä¸å†™åœ¨è¢«returnçš„functioné‡Œé¢å‘¢ï¼Ÿ
    let timer
    return function(...args){
      const later = ()=>{
        // 1âƒ£ï¸delay æ—¶é—´åˆ°äº†æ–°äº‹ä»¶æœªå†è§¦å‘ï¼Œlaterè¢«æ‰§è¡Œï¼Œæ¸…é™¤è¿™è½®è®¡æ—¶
        clearTimeout(timer) // æˆ–è€… timer = nullï¼Œâ“äºŒè€…çš„åŒºåˆ«æ˜¯ä»€ä¹ˆ
        func(...args)
      }
      // 2âƒ£ï¸delayæ—¶é—´æœªåˆ°ä½†æ–°äº‹ä»¶å·²è§¦å‘ï¼Œæ¸…é™¤è¿™è½®è®¡æ—¶ï¼Œé‡æ–°èµ‹å€¼è®¡æ—¶å™¨å¼€å§‹æ–°ä¸€è½®è®¡æ—¶
      clearTimeout(timer) 
      // åœ¨è¿™èµ‹å€¼äº†å®šæ—¶å™¨ï¼Œåœ¨ case1âƒ£ï¸æˆ–è€…2âƒ£ï¸æ—¶è¢«æ¸…é™¤
      timer = setTimeout(later, delay) 
    }
  }
  
  
  // å†™æ³•2 ï¼ˆä¸ªäººæ¨èğŸ‘ï¼‰
  function debounce(fn, delay) {
      let timer=null;
      return function(){
          clearTimeout(timer);
          timer = setTimeout(fn,time);
      }
  }
  
  // å†™æ³•3
  function debounce(fun, delay) {
      return function (args) {
          let that = this
          let _args = args
          clearTimeout(fun.id)
          fun.id = setTimeout(function () {
              fun.call(that, _args)
          }, delay)
      }
  }
  ```

- thisæŒ‡å‘é—®é¢˜

  ```html
  <div onclick='handleClick()'>ç‚¹å‡»</div> 
  <script>
    const fn = ()=>{
      console.log(this)
    }
    const handleClick = debounce(fn, 1000) // è¢«debounceåŒ…è£¹åï¼ŒthisæŒ‡å‘ä¸æ­£ç¡®ï¼Œå˜ä¸º
  </script>
  ```

  

  ```tsx
  ```

  

***:question:é—®é¢˜ï¼š***

- ä¸ºä»€ä¹ˆ ```let timer``` ä¸å†™åœ¨è¢«returnçš„functioné‡Œé¢å‘¢

- ```clearTimeout(timer)``` ä¸ ```timer = null``` åŒºåˆ«

  [å‚è€ƒèµ„æ–™](https://blog.csdn.net/qq_39039128/article/details/105714365)

  > timerçš„å€¼ä¸ºéšæœºæ•°å­—idï¼Œ
  >
  > clearTimeoutåï¼Œtimerçš„å˜é‡æŒ‡å‘æ•°å­—idè¿˜åœ¨ï¼Œ åªæ˜¯å®šæ—¶å™¨åœæ­¢äº†ã€‚
  > æŠŠtimerèµ‹å€¼ä¸ºnullï¼Œæ˜¯ä¸ºäº†é‡Šæ”¾å†…å­˜ï¼ŒåŒæ—¶ä¹Ÿæ–¹ä¾¿å¸ƒå°”åˆ¤æ–­å§



## å‡½æ•°èŠ‚æµ Throttle



### throttleä½œç”¨

:wrench: äº‹ä»¶å‘ç”Ÿåï¼Œäº‹ä»¶å¤„ç†å‡½æ•°åœ¨nç§’åæ‰§è¡Œä¸€æ¬¡ï¼Œä¸ç®¡è¿™æ®µæ—¶é—´æœ‰æ— äº‹ä»¶ç»§ç»­å‘ç”Ÿ

**å³æ§åˆ¶äº‹ä»¶å¤„ç†å‡½æ•°æ‰§è¡Œé¢‘ç‡ï¼Œæ¯éš”nç§’æ‰§è¡Œä¸€æ¬¡**



### æ‰‹å†™èŠ‚æµ

```javascript
// æ–¹æ³•1ï¼ˆä¸ªäººæ¨èğŸ‘ï¼‰
const throttle = (fn, delay)=>{
  // å‰ä¸€æ¬¡äº‹ä»¶å¤„ç†å‡½æ•°æ‰§è¡Œæ—¶çš„æ—¶é—´æˆ³
	let previous = 0 
  return function(...args){
    // æ­¤åˆ»çš„æ—¶é—´æˆ³æˆ³ï¼Œâœ¨è¿™ä¸ªå¤„ç†å¾ˆæœ‰æ„æ€äº†
    let now = +new Date()
    // å¦‚æœæ—¶é—´é—´éš”åˆ°äº†nç§’
    if(now - previous > delay){ 
      previous = now
      fn.apply(this, args)
    }
  }
}


// æ–¹æ³•2
function throttle(fun, delay) {
  let last, deferTimer
  return function (args) {
    let that = this
    let _args = arguments
    let now = +new Date()
    if (last && now < last + delay) {
      clearTimeout(deferTimer)
      deferTimer = setTimeout(function () {
        last = now
        fun.apply(that, _args)
      }, delay)
    }else {
      last = now
      fun.apply(that,_args)
    }
  }
}
```





## å·¥å…·åº“



### underscore





### lodash



## å‚è€ƒ

- [1] [levelupèµ„æ–™](https://levelup.gitconnected.com/debounce-in-javascript-improve-your-applications-performance-5b01855e086)
- [2] [é˜²æŠ–å’ŒèŠ‚æµæ•ˆæœå¯è§†åŒ–å›¾](http://demo.nimius.net/debounce_throttle/)
- [3] [underscoreæºç è§£è¯»](https://github.com/sisterAn/JavaScript-Algorithms/issues/92)
- [4] [lodashæºç åˆ†æ](https://juejin.cn/post/6844903879017021454#heading-20)

- [5] [å†´ç¾½åšå®¢](https://github.com/mqyqingfeng/Blog/issues/22)

|å­—ç¬¦|è½¬ä¹‰åçš„å­—ç¬¦| |-|-| |`&`|`&`| |`<`|`<`| |`>`|`>`| |`"`|`"`| |`'`|`'`| |`/`|`/`|
